<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kotweb — Secure Entry</title>
  <style>
    :root {
      --bg: #000;
      --orange: #ff7a00;
      --white: #fff;
      --muted: #999;
      --error: #ff3333;
      --success: #33ff66;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Inter', system-ui, Arial, sans-serif;
      background: var(--bg);
      color: var(--white);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      align-items: center;
      justify-content: center;
      padding: 20px;
      text-align: center;
    }
    
    h1 {
      color: var(--orange);
      margin: 0 0 8px 0;
      font-size: 2.5rem;
    }
    
    .desc {
      margin-bottom: 30px;
      color: var(--muted);
    }
    
    .ads {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 30px;
    }
    
    .ad-box {
      width: 360px;
      height: 200px;
      border: 2px dashed var(--muted);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      cursor: pointer;
      position: relative;
      color: var(--muted);
      white-space: pre-line;
      text-align: center;
    }
    
    .ad-box:hover {
      border-color: var(--orange);
      color: var(--white);
    }
    
    .ad-box img, .ad-box video, .ad-box iframe {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .feedback {
      height: 40px;
      margin-bottom: 20px;
      font-weight: 600;
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .grid-container {
      display: flex;
      justify-content: center;
      margin-bottom: 30px;
    }
    
    .grid {
      display: grid;
      grid-template-columns: repeat(6, 60px);
      gap: 12px;
    }
    
    .grid button {
      width: 60px;
      height: 60px;
      background: var(--bg);
      border: 2px solid var(--orange);
      color: var(--white);
      font-size: 18px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s;
      border-radius: 0;
    }
    
    .grid button:hover {
      background: var(--orange);
      color: #000;
    }
    
    .grid button.correct {
      background: var(--success);
      color: #000;
      border-color: transparent;
    }
    
    .grid button.wrong {
      background: var(--error);
      color: #000;
      border-color: transparent;
    }
    
    footer {
      margin-top: 40px;
      font-size: 14px;
      color: var(--muted);
    }
  </style>
</head>
<body>
  <h1>Kotweb</h1>
  <div class="desc">Welcome to my world. Share with full privacy. Enjoy in the darkness.</div>

  <div class="ads" id="adsArea">
    <div class="ad-box">Ad Area\nContact me\nSize: 360x200</div>
    <div class="ad-box">Ad Area\nContact me\nSize: 360x200</div>
  </div>

  <div id="feedback" class="feedback" aria-live="polite"></div>

  <div class="grid-container">
    <div class="grid" id="pinGrid" role="group" aria-label="PIN entry pad"></div>
  </div>

  <footer>Made by Kotweb ✨</footer>

  <audio id="yesSound" src="yes.mp3" preload="auto"></audio>
  <audio id="noSound" src="no.mp3" preload="auto"></audio>

  <!-- Firebase SDK -->
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-analytics.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyAsfXkzcFVmsQLWGF_WqCPQWn7SRqkcvK8",
      authDomain: "kotweb-dd995.firebaseapp.com",
      databaseURL: "https://kotweb-dd995-default-rtdb.firebaseio.com",
      projectId: "kotweb-dd995",
      storageBucket: "kotweb-dd995.firebasestorage.app",
      messagingSenderId: "534760591484",
      appId: "1:534760591484:web:1c90379da7852ddec2f9f9",
      measurementId: "G-9ZH53YSQZT"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const db = getFirestore(app);

    // Load ads from Firestore
    async function loadAds() {
      const adsArea = document.getElementById('adsArea');
      const adBoxes = adsArea.querySelectorAll('.ad-box');
      
      try {
        const querySnapshot = await getDocs(collection(db, 'ads'));
        const ads = [];
        
        querySnapshot.forEach(doc => {
          ads.push(doc.data());
        });
        
        // Ensure we always have exactly 2 ad boxes
        while (ads.length < 2) {
          ads.push(null); // Add empty slots for missing ads
        }
        
        // Update ad boxes with content
        for (let i = 0; i < 2; i++) {
          const data = ads[i];
          const box = adBoxes[i];
          
          if (data) {
            if (data.link) {
              box.onclick = () => window.open(data.link, '_blank');
            } else {
              box.onclick = () => {
                navigator.clipboard.writeText('karekezibertrand@gmail.com')
                  .then(() => alert('Email copied to clipboard: karekezibertrand@gmail.com'));
              };
            }
            
            if (data.image) { 
              box.innerHTML = `<img src='${data.image}' alt='${data.description || 'Advertisement'}'/>`;
            } else if (data.youtube) { 
              box.innerHTML = `<iframe width='100%' height='100%' src='${data.youtube}?autoplay=1&mute=1' frameborder='0' allow='autoplay; encrypted-media' allowfullscreen title='${data.description || 'Advertisement'}'></iframe>`;
            } else if (data.video) { 
              box.innerHTML = `<video src='AdVideos/${data.video}' autoplay muted loop title='${data.description || 'Advertisement'}'></video>`;
            } else {
              box.textContent = data.description || 'Ad Area\nContact me\nSize: 360x200';
            }
          } else {
            // Empty ad slot
            box.innerHTML = 'Ad Area\nContact me\nSize: 360x200';
            box.onclick = () => {
              navigator.clipboard.writeText('karekezibertrand@gmail.com')
                .then(() => alert('Email copied to clipboard: karekezibertrand@gmail.com'));
            };
          }
        }
      } catch (e) {
        console.error('Error loading ads:', e);
        // Keep the placeholder ads if there's an error
      }
    }

    // Load ads when the page is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadAds);
    } else {
      loadAds();
    }
  </script>

  <script>
    // PIN entry functionality
    const CORRECT_PIN = "2580";
    let currentInput = "";
    let attempts = 0;
    let totalWrongClicks = 0;
    const feedback = document.getElementById('feedback');
    const yesSound = document.getElementById('yesSound');
    const noSound = document.getElementById('noSound');

    const positiveMsgs = ["Wooh!", "Excellent", "Nice one", "Exact", "You are made for it", "Perfect!", "Awesome"];
    const negativeMsgs = ["Noh", "Incorrect", "Bruh", "WHT ???", "Wait what", "Are you kidding", "Go back broh", "Not your stuff"];

    // Create the PIN grid (0-29)
    const grid = document.getElementById('pinGrid');
    for (let i = 0; i < 30; i++) {
      const btn = document.createElement('button');
      btn.textContent = i;
      btn.setAttribute('type', 'button');
      btn.setAttribute('aria-label', `Number ${i}`);
      btn.onclick = () => handleClick(btn, i);
      grid.appendChild(btn);
    }

    function handleClick(btn, num) {
      currentInput += num;
      
      if (currentInput === CORRECT_PIN.substring(0, currentInput.length)) {
        // Correct digit
        btn.classList.add('correct');
        playSound(true);
        feedback.textContent = randomMsg(positiveMsgs);
      } else {
        // Wrong digit
        btn.classList.add('wrong');
        playSound(false);
        feedback.textContent = randomMsg(negativeMsgs);
        currentInput = "";
        totalWrongClicks++;
        
        // Reset all buttons
        setTimeout(() => {
          document.querySelectorAll('.grid button').forEach(b => {
            b.classList.remove('correct', 'wrong');
          });
        }, 400);
      }

      // Check if PIN is complete
      if (currentInput.length === 4) {
        if (currentInput === CORRECT_PIN) {
          // Correct PIN
          feedback.textContent = "Access granted! Redirecting...";
          setTimeout(() => {
            location.href = 'login.html';
          }, 600);
        } else {
          // Wrong PIN
          attempts++;
          currentInput = "";
          
          if (attempts >= 3) {
            feedback.textContent = "Oh Sorry Kotweb is not your type...";
            setTimeout(() => {
              location.href = 'https://i.pinimg.com/736x/1c/8f/b9/1c8fb9feaf1267dec6cfd42660f5e14d.jpg';
            }, 1000);
          }
        }
      }

      // Check for too many wrong clicks
      if (totalWrongClicks >= 7) {
        feedback.textContent = "Too many wrong attempts...";
        setTimeout(() => {
          location.href = 'https://i.pinimg.com/736x/1c/8f/b9/1c8fb9feaf1267dec6cfd42660f5e14d.jpg';
        }, 500);
      }
    }

    function randomMsg(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }
    
    function playSound(ok) {
      try {
        if (ok) {
          yesSound.currentTime = 0;
          yesSound.play();
        } else {
          noSound.currentTime = 0;
          noSound.play();
        }
      } catch (e) {
        console.error('Error playing sound:', e);
      }
    }
  </script>
</body>
</html>
